<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Survey</title>
    <script src="https://code.jquery.com/jquery.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0-alpha.4/css/materialize.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0-alpha.4/js/materialize.min.js"></script>

</head>

<body class="teal lighten-3">
    <div class="container white z-depth-3">
        <h2 class="center-align">Survey Questions</h2>

        <!-- FORM -->
        <div class="row">
            <form class="col s12">

                <h5>About You</h5>
                <div class="row">
                    <div class="input-field col s12">
                        <input name="name" placeholder="Name" id="name" type="text" class="validate">
                        <label for="name">Name</label>
                    </div>
                </div>

                <div class="row">
                    <div class="input-field col s12">
                        <input name="photo" placeholder="Link to Image" id="photo" type="text" class="validate">
                        <label for="photo">Link to Image</label>
                    </div>
                </div>

                <div class="row">
                    <h5>1) You are well organized.</h5>
                    <div class="input-field col s12">
                        <select name="q1">
                            <option value="" disabled selected>Choose your option</option>
                            <option value="1">1 (Strongly Disagree)</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">3</option>
                            <option value="5">5 (Strongly Agree)</option>
                        </select>
                        <label>Question 1</label>
                    </div>
                </div>

                <div class="row">
                    <h5>2) You spend time reflecting on things.</h5>
                    <div class="input-field col s12">
                        <select name="q2">
                            <option value="" disabled selected>Choose your option</option>
                            <option value="1">1 (Strongly Disagree)</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">3</option>
                            <option value="5">5 (Strongly Agree)</option>
                        </select>
                        <label>Question 2</label>
                    </div>
                </div>

                <div class="row">
                    <h5>3) You find it easy to stay relaxed and focused even when there is some pressure.</h5>
                    <div class="input-field col s12">
                        <select name="q3">
                            <option value="" disabled selected>Choose your option</option>
                            <option value="1">1 (Strongly Disagree)</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">3</option>
                            <option value="5">5 (Strongly Agree)</option>
                        </select>
                        <label>Question 3</label>
                    </div>
                </div>

                <div class="row">
                    <h5>4) You rarely do something just out of sheer curiosity.</h5>
                    <div class="input-field col s12">
                        <select name="q4">
                            <option value="" disabled selected>Choose your option</option>
                            <option value="1">1 (Strongly Disagree)</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">3</option>
                            <option value="5">5 (Strongly Agree)</option>
                        </select>
                        <label>Question 4</label>
                    </div>
                </div>

                <div class="row">
                    <h5>5) People can rarely upset you.</h5>
                    <div class="input-field col s12">
                        <select name="q5">
                            <option value="" disabled selected>Choose your option</option>
                            <option value="1">1 (Strongly Disagree)</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">3</option>
                            <option value="5">5 (Strongly Agree)</option>
                        </select>
                        <label>Question 5</label>
                    </div>
                </div>

                <div class="row">
                    <h5>6) You sympathize with others' feelings.</h5>
                    <div class="input-field col s12">
                        <select name="q6">
                            <option value="" disabled selected>Choose your option</option>
                            <option value="1">1 (Strongly Disagree)</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">3</option>
                            <option value="5">5 (Strongly Agree)</option>
                        </select>
                        <label>Question 6</label>
                    </div>
                </div>

                <div class="row">
                    <h5>7) You care a lot about what other people think of you.</h5>
                    <div class="input-field col s12">
                        <select name="q7">
                            <option value="" disabled selected>Choose your option</option>
                            <option value="1">1 (Strongly Disagree)</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">3</option>
                            <option value="5">5 (Strongly Agree)</option>
                        </select>
                        <label>Question 7</label>
                    </div>
                </div>

                <div class="row">
                    <h5>8) You like to take charge of situations and events.</h5>
                    <div class="input-field col s12">
                        <select name="q8">
                            <option value="" disabled selected>Choose your option</option>
                            <option value="1">1 (Strongly Disagree)</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">3</option>
                            <option value="5">5 (Strongly Agree)</option>
                        </select>
                        <label>Question 8</label>
                    </div>
                </div>

                <div class="row">
                    <h5>9) You are always busy- always on the go.</h5>
                    <div class="input-field col s12">
                        <select name="q9">
                            <option value="" disabled selected>Choose your option</option>
                            <option value="1">1 (Strongly Disagree)</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">3</option>
                            <option value="5">5 (Strongly Agree)</option>
                        </select>
                        <label>Question 9</label>
                    </div>
                </div>

                <div class="row">
                    <h5>10) You love hanging out with big groups of people</h5>
                    <div class="input-field col s12">
                        <select name="q10">
                            <option value="" disabled selected>Choose your option</option>
                            <option value="1">1 (Strongly Disagree)</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">3</option>
                            <option value="5">5 (Strongly Agree)</option>
                        </select>
                        <label>Question 10</label>
                    </div>
                </div>

                <button class="btn waves-effect waves-light" type="submit" id="submit" name="action">Submit</button>

            </form>
        </div>
        <br>


        <!-- MODAL-->
        <div id="modal1" class="modal teal lighten-3">
            <div class="modal-content">
                <div class="row">
                    <h3 class="center-align">Your Best Match:</h3>
                </div>
                <div class="row">
                    <div class="col s8 offset-s2">
                        <div class="card">
                            <div class="card-image">
                                <img id="image" src="">
                                <h6 id="displayName" class="center-align"></h6>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <a href="#!" class="modal-action modal-close waves-effect waves-green btn-flat">Close</a>
            </div>
        </div>

    </div>

    <footer>
            <div class="footer-copyright">
                <div class="container grey-text text-lighten-2">
                    <br>
                    <a class="grey-text text-lighten-3" href="/api/friends">API Friends List</a> |
                    <a class="grey-text text-lighten-3" href="https://github.com/jshreck/FriendFinder">GitHub Repo</a>
                </div>
            </div>
        </footer>

</body>

<!-- JAVASCRIPT -->
<script type="text/javascript">

    //initialize for selecting options
    $(document).ready(function () {
        $('select').formSelect();
        $('.modal').modal();
    });

    $("#submit").on("click", (event) => {
        event.preventDefault();

        //validate to make sure form is complete
        var formValuesArray = $("form").serializeArray();
        if (formValuesArray.length < 4) {
            alert("You didn't fill in everything.");
            return;
        }

        
        //make friend object from survey results
        var friend = {
            name: $("#name").val().trim(),
            photo: $("#photo").val().trim(),
            scores: []
        };

        //populate the scores with results selected
        $("select").each((index, value) => {
            if (value === null) {
                console.log("empty");
            }
            friend.scores.push($(value).val());
        });

        //send object 
        var currentURL = window.location.origin;
        $.post(currentURL + "/api/friends", friend, (res) => {
            //populating modal text
            $("#displayName").html(res[0].name);
            $("#image").attr("src", res[0].photo);
            //display modal
            $('.modal').modal('open');
            
        });
    });

</script>


</html>